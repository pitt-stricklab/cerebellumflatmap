# MarmosetCerebellumFlatmapTool
MarmosetCerebellumFlatmapTool is a MATLAB app for displaying flatmaps of the marmoset cerebellum and mapping intensity data and point clouds onto those flatmaps.

## Features
* **Flatmap Types**: Display a label flatmap (show regions), a border flatmap (show region borders), and a curvature flatmap (show surface concavity and convexity).
* **Intensity Mapping**: Display an intensity flatmap by mapping 3D intensity data registered to the standardized marmoset cerebellum atlas.
* **Point Mapping**: Map arbitrary 3D point clouds onto any flatmap type (label, border, curvature, or intensity).
* **Deployment Modes**: Run within MATLAB as an app, or as a standalone application on Windows, macOS, and Linux (requires MATLAB Runtime).

<img src=https://github.com/user-attachments/assets/67d21986-078a-4cea-83e6-de1a01ef1afd width="40%"><img src=https://github.com/user-attachments/assets/034f6f07-6150-4db3-8c8a-dd777d11cc48 width="40%"><img src=https://github.com/user-attachments/assets/027bfb3b-ddb8-4452-b416-c5664adab858 width="40%"><img src=https://github.com/user-attachments/assets/0d32df45-5706-4065-9ab1-fd15a59dea59 width="40%">

## Requirements
These versions have been tested and confirmed; other versions are untested.
* MATLAB (24.2)
* Image Processing Toolbox (24.2)
* Statistics and Machine Learning Toolbox (24.2)
* MATLAB Runtime R2024b (24.2) for standalone execution  

## File Organization
```text
main/
├── functions/
└── pCerebellumFlatmap/
    ├── pMarmosetCerebellumFlatmapTool/
    │   ├── data/
    │   │   ├── data.mat                        % Data file containing a CerebellumFlatmapGenerator handle, used by MarmosetCerebellumFlatmapTool.
    │   │   ├── sample_intensity.nii.gz         % Sample cerebellum intensity data registered to the 3D standard marmoset cerebellar atlas.
    │   │   └── sample_point_cloud.csv          % Sample point-cloud coordinates within the cerebellum registered to the 3D standard marmoset cerebellar atlas.
    │   └── MarmosetCerebellumFlatmapTool.mlapp % App Designer file for an application that displays flatmaps generated by CerebellumFlatmapGenerator and maps intensity data and point clouds.
    ├── CerebellumFlatmapGenerator.m            % This class uses FlatmapGenerator to create various flatmaps from 3D marmoset cerebellum label data.
    └── FlatmapGenerator.m                      % This class generates flatmaps from 3D volume data segmented by label indices.
```

## Distribution Packages
Prebuilt packages are available under [Releases](https://github.com/pitt-stricklab/cerebellumflatmap/releases).
* **Windows x64**: `mcft-windows-x64-vX.Y.zip`
* **Linux x64**: `mcft-linux-x64-vX.Y.tar.gz`
* **macOS x64**: `mcft-macos-x64-vX.Y.tar.gz`
* **MATLAB App Installer**: `mcft-matlabapp-vX.Y.mlappinstall`

> **Note (macOS only)**:  
> macOS Gatekeeper tags downloaded archives with a quarantine attribute, which can lead to a "<Application> is damaged and can't be opened" error. To remove the tag before unpacking, run:
> ```
> xattr -dr com.apple.quarantine mcft-macos-x64-vX.Y.tar.gz
> ```
